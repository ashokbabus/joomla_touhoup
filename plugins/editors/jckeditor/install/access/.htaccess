### ===========================================================================
### Security Enhanced & Highly Optimized .htaccess File for Joomla!
### automatically generated by Admin Tools ADMINTOOLS_VERSION on 2012-07-26 16:02:12 GMT
### Auto-detected Apache version: 2.2 (best guess)
### ===========================================================================
###
### The contents of this file are based on the same author's work "Master
### .htaccess", published on http://snipt.net/nikosdion/the-master-htaccess
###
### Admin Tools is Free Software, distributed under the terms of the GNU
### General Public License version 3 or, at your option, any later version
### published by the Free Software Foundation.
###
### !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANT !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
### !!                                                                       !!
### !!  If you get an Internal Server Error 500 or a blank page when trying  !!
### !!  to access your site, remove this file and try tweaking its settings  !!
### !!  in the back-end of the Admin Tools component.                        !!
### !!                                                                       !!
### !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
###

##### RewriteEngine enabled - BEGIN
RewriteEngine On
##### RewriteEngine enabled - END

##### RewriteBase set - BEGIN
RewriteBase /
##### RewriteBase set - END

##### File execution order -- BEGIN
DirectoryIndex index.php index.html
##### File execution order -- END

##### No directory listings -- BEGIN
IndexIgnore *
Options All -Indexes
##### No directory listings -- END

##### Redirect index.php to / -- BEGIN
RewriteCond %{THE_REQUEST} !^POST
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php\ HTTP/
RewriteCond %{SERVER_PORT}>s ^(443>(s)|[0-9]+>s)$
RewriteRule ^index\.php$ http%2://stagingj250.joomlackeditor.com/ [R=301,L]
##### Redirect index.php to / -- END
##### Rewrite rules to block out some common exploits -- BEGIN
RewriteCond %{QUERY_STRING} proc/self/environ [OR]
RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
RewriteCond %{QUERY_STRING} base64_(en|de)code\(.*\) [OR]
RewriteCond %{QUERY_STRING} (<|%3C).*script.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
RewriteRule .* index.php [F]
##### Rewrite rules to block out some common exploits -- END
##### File injection protection -- BEGIN
RewriteCond %{REQUEST_METHOD} GET
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=http:// [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=(\.\.//?)+ [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=/([a-z0-9_.]//?)+ [NC]
RewriteRule .* - [F]
##### File injection protection -- END

##### Advanced server protection rules exceptions -- BEGIN
RewriteRule ^administrator\/components\/com_akeeba\/restore\.php$ - [L]
RewriteRule ^administrator\/components\/com_admintools\/restore\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/install\/index\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/fields\/combo\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jtreelink\/dialogs\/initialize\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jtreelink\/dialogs\/links\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jfilebrowser\/core\/connector\/php\/connector\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/index\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/phpthumb\/phpThumb\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/view_details\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/view_tiles\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/view_content\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/view_list\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/view_images_large\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/view_images_small\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/file_specs\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/swfupload\/upload\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/actions\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/process\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jckexplorer\/close\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/ImageManager\/manager\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/ImageManager\/images\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/ImageManager\/thumbs\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/ImageManager\/editor\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/ImageManager\/editorFrame\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jlink\/dialogs\/suggest\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jautosave\/autosave\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/texttranslate\/gotranslate\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/atdckeditor\/proxy\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/aspell\/spellerpages\/server-scripts\/spellchecker\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jallvideos\/dialogs\/event\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jsimpleimagegallery\/dialogs\/event\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/articlepreview\/index\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/typography\/typography\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jallvideos\/dialogs\/updatemediatype\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/GeSHi\/dialogs\.dialog\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/GeSHi\/dialogs\/dialog\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/jdoclink\/params\.config$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/imageresize\/imageresize\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/imageresize\/simpleimage\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/htmlfilters\/ajaxfilters\.php$ - [L]
RewriteRule ^plugins\/editors\/jckeditor\/plugins\/htmlfilters\/helper\/helper\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !(\.php)$
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^plugins\/editors\/jckeditor\/install/ - [L]
RewriteCond %{REQUEST_FILENAME} !(\.php)$
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^plugins\/editors\/jckeditor\/\.\.\/\.\.\/\.\.\/files/ - [L]
RewriteRule ^templates\/your_template_name_here/ - [L]
##### Advanced server protection rules exceptions -- END

##### Advanced server protection -- BEGIN

RewriteCond %{QUERY_STRING} \=PHP[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12} [NC]
RewriteRule .* - [F]
## Back-end protection
RewriteRule ^administrator/?$ - [L]
RewriteRule ^administrator/index\.(php|html?)$ - [L]
RewriteRule ^administrator/index[23]\.php$ - [L]
RewriteRule ^administrator/(components|modules|templates|images|plugins)/.*\.(jpe|jpg|jpeg|jp2|jpe2|png|gif|bmp|css|js|swf|html|mpg|mp3|mpeg|mp4|avi|wav|ogg|ogv|xls|xlsx|doc|docx|ppt|pptx|zip|rar|pdf|xps|txt|7z|svg|odt|ods|odp|flv|mov|htm|ttf|woff|eot)$ - [L]
RewriteRule ^administrator/ - [F]
## Explicitly allow access only to XML-RPC's xmlrpc/index.php or plain xmlrpc/ directory
RewriteRule ^xmlrpc/(index\.php)?$ - [L]
RewriteRule ^xmlrpc/ - [F]
## Allow limited access for certain Joomla! system directories with client-accessible content
RewriteRule ^(components|modules|templates|images|plugins|media|libraries)/.*\.(jpe|jpg|jpeg|jp2|jpe2|png|gif|bmp|css|js|swf|html|mpg|mp3|mpeg|mp4|avi|wav|ogg|ogv|xls|xlsx|doc|docx|ppt|pptx|zip|rar|pdf|xps|txt|7z|svg|odt|ods|odp|flv|mov|ico|htm|ttf|woff|eot)$ - [L]
RewriteRule ^(components|modules|templates|images|plugins|media|libraries)/.*index\.php - [L]
RewriteRule ^(components|modules|templates|images|plugins|media|libraries)/ - [F]
## Disallow front-end access for certain Joomla! system directories (unless access to their files is allowed above)
RewriteRule ^includes/js/ - [L]
RewriteRule ^(cache|includes|language|logs|tmp)/ - [F]

## Disallow access to rogue PHP files throughout the site, unless they are explicitly allowed
RewriteCond %{REQUEST_FILENAME} (\.php)$
RewriteCond %{REQUEST_FILENAME} !(/index[23]?\.php)$
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule (.*\.php)$ - [F]
## Disallow access to htaccess.txt, php.ini and configuration.php-dist
RewriteRule ^(htaccess\.txt|configuration\.php-dist|php\.ini)$ - [F]
##### Advanced server protection -- END

##### Joomla! core SEF Section -- BEGIN
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteCond %{REQUEST_URI} !^/index\.php
RewriteCond %{REQUEST_URI} /component/|(/[^.]*|\.(php|html?|feed|pdf|raw|ini|zip|json|file|vcf))$ [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php [L]
##### Joomla! core SEF Section -- END




